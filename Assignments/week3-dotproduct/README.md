# CS205	C/	C++	Program	Design	- Assignment	3  
- 最优运算时间：对于200M个数据(总长为2亿的浮点数据)**运算耗时13ms**  
- 最优程序耗时：2亿数据**包括IO用时**(读数据到计算结束)**总共耗时88ms**  
- 最优IO时间：（文件映射）**0ms**   
## *程序尝试采用的优化方法*  
- 对于TXT文本  
需要超过10分钟的生成/运算  
- 对于二进制文件
采用文件流方式读入只需5秒即可完成运算；  
采用C风格的方式读取（文件指针）会比文件流更快些；
采用内存拷贝（直接将文件加载到内存中）IO用时为0；  
- 对于多线程  
定义了一个获取CPU核数的方法（支持windows和linux双系统，支持64/32位）  
在内核效率相近的情况下，多线程最优线程数=CPU核数  **采用多线程可以使程序优化5倍以上**  
- 对于多路循环  
在二，四，八路循环中，四路效率最佳（会因CPU和数据而不同），**加速效果在2倍以上**  
同时在多路循环的基本运算中将float强制转换为double运算速度可以小幅度提升效率  
多路运算可以增加一个slp指令前压缩的运算内容  
- 对于SSE指令集优化  
在本机的测试中，SSE表现和八路循环效果相近，并不是最优  
## *与openBLAS的性能比较*  
- 直接调用openblas  
sdot耗时100+ms，dsdot耗时300+ms  
- 多线程调用openblas  
sdot耗时40+ms，dsdot耗时50+ms  
- 对比
在float精度下，只有单线程时blas略优于此程序；  
在double精度下，无论单线程还是多线程此程序都优于openBlas；
【原因】  
![截图]()  
## *关于精度的探讨*  

【对比】  

![截图]()  
## *程序的设计*  
【程序各个方法的介绍】  
![截图](https://github.com/GhostFrankWu/SUSTech_CS205_C-Cpp_2020F/blob/master/Assignments/week3-dotproduct/sc/sc1.png)  
